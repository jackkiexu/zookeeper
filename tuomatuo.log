[2017-04-13 17:55:57,553] INFO  main (ZKTestCase.java:50) - STARTING testCnxManager
[2017-04-13 17:55:57,565] INFO  main (PortAssignment.java:32) - assigning port 11221
[2017-04-13 17:55:57,567] INFO  main (PortAssignment.java:32) - assigning port 11222
[2017-04-13 17:55:57,575] INFO  main (PortAssignment.java:32) - assigning port 11223
[2017-04-13 17:55:57,660] INFO  main (PortAssignment.java:32) - assigning port 11224
[2017-04-13 17:55:57,661] INFO  main (PortAssignment.java:32) - assigning port 11225
[2017-04-13 17:55:57,661] INFO  main (PortAssignment.java:32) - assigning port 11226
[2017-04-13 17:55:57,666] INFO  main (PortAssignment.java:32) - assigning port 11227
[2017-04-13 17:55:57,667] INFO  main (PortAssignment.java:32) - assigning port 11228
[2017-04-13 17:55:57,667] INFO  main (PortAssignment.java:32) - assigning port 11229
[2017-04-13 17:55:58,526] WARN  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (Follower.java:89) - Exception when following the leader
java.net.SocketTimeoutException: Read timed out
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:170)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:103)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:153)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:787)
[2017-04-13 17:55:58,536] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (Follower.java:166) - shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:791)
[2017-04-13 17:55:58,536] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (FollowerZooKeeperServer.java:139) - Shutting down
[2017-04-13 17:55:58,537] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (ZooKeeperServer.java:445) - shutting down
[2017-04-13 17:55:58,537] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (FollowerRequestProcessor.java:105) - Shutting down
[2017-04-13 17:55:58,537] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (CommitProcessor.java:181) - Shutting down
[2017-04-13 17:55:58,537] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (FinalRequestProcessor.java:415) - shutdown of request processor complete
[2017-04-13 17:57:00,199] INFO  main (CnxManagerTest.java:75) - peerTmpdir:[Ljava.io.File;@704921a5
[2017-04-13 17:57:06,009] INFO  main (JUnit4ZKTestRunner.java:50) - RUNNING TEST METHOD testCnxManager
[2017-04-13 17:57:18,089] INFO  Thread-0 (NIOServerCnxnFactory.java:94) - binding to port 0.0.0.0/0.0.0.0:11222
[2017-04-13 17:57:18,089] INFO  main (NIOServerCnxnFactory.java:94) - binding to port 0.0.0.0/0.0.0.0:11225
[2017-04-13 17:57:20,052] INFO  main (JUnit4ZKTestRunner.java:62) - TEST METHOD FAILED testCnxManager
java.net.BindException: Address already in use: bind
	at sun.nio.ch.Net.bind0(Native Method)
	at sun.nio.ch.Net.bind(Net.java:433)
	at sun.nio.ch.Net.bind(Net.java:425)
	at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:67)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.configure(NIOServerCnxnFactory.java:95)
	at org.apache.zookeeper.server.ServerCnxnFactory.createFactory(ServerCnxnFactory.java:129)
	at org.apache.zookeeper.server.quorum.QuorumPeer.<init>(QuorumPeer.java:564)
	at org.apache.zookeeper.server.quorum.CnxManagerTest.testCnxManager(CnxManagerTest.java:135)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:78)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:212)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:68)
[2017-04-13 17:57:20,057] INFO  main (ZKTestCase.java:65) - FAILED testCnxManager
java.net.BindException: Address already in use: bind
	at sun.nio.ch.Net.bind0(Native Method)
	at sun.nio.ch.Net.bind(Net.java:433)
	at sun.nio.ch.Net.bind(Net.java:425)
	at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:223)
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:74)
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:67)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.configure(NIOServerCnxnFactory.java:95)
	at org.apache.zookeeper.server.ServerCnxnFactory.createFactory(ServerCnxnFactory.java:129)
	at org.apache.zookeeper.server.quorum.QuorumPeer.<init>(QuorumPeer.java:564)
	at org.apache.zookeeper.server.quorum.CnxManagerTest.testCnxManager(CnxManagerTest.java:135)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.apache.zookeeper.JUnit4ZKTestRunner$LoggedInvokeMethod.evaluate(JUnit4ZKTestRunner.java:52)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.rules.TestWatchman$1.evaluate(TestWatchman.java:48)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:78)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:212)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:68)
[2017-04-13 17:57:20,063] INFO  main (ZKTestCase.java:55) - FINISHED testCnxManager
[2017-04-13 17:55:58,537] INFO  CommitProcessor:1 (CommitProcessor.java:150) - CommitProcessor exited loop!
[2017-04-13 17:55:58,543] INFO  FollowerRequestProcessor:1 (FollowerRequestProcessor.java:95) - FollowerRequestProcessor exited loop!
[2017-04-13 17:55:58,538] INFO  QuorumPeer[myid=1]/0:0:0:0:0:0:0:0:11221 (SyncRequestProcessor.java:209) - Shutting down
[2017-04-13 17:57:26,305] WARN  QuorumPeer[myid=2]/0:0:0:0:0:0:0:0:11223 (Follower.java:89) - Exception when following the leader
java.net.SocketTimeoutException: Read timed out
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:170)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:103)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:153)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:787)
[2017-04-13 17:57:26,305] ERROR LearnerHandler-/127.0.0.1:60330 (LearnerHandler.java:633) - Unexpected exception causing shutdown while sock still open
java.net.SocketTimeoutException: Read timed out
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:170)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:103)
	at org.apache.zookeeper.server.quorum.LearnerHandler.run(LearnerHandler.java:546)
[2017-04-13 17:57:26,310] WARN  LearnerHandler-/127.0.0.1:60330 (LearnerHandler.java:646) - ******* GOODBYE /127.0.0.1:60330 ********
[2017-04-13 17:57:42,157] INFO  main (ZKTestCase.java:50) - STARTING testCnxManager
[2017-04-13 17:57:42,162] INFO  main (PortAssignment.java:32) - assigning port 11221
[2017-04-13 17:57:42,164] INFO  main (PortAssignment.java:32) - assigning port 11222
[2017-04-13 17:57:42,173] INFO  main (PortAssignment.java:32) - assigning port 11223
[2017-04-13 17:57:42,264] INFO  main (PortAssignment.java:32) - assigning port 11224
[2017-04-13 17:57:42,264] INFO  main (PortAssignment.java:32) - assigning port 11225
[2017-04-13 17:57:42,264] INFO  main (PortAssignment.java:32) - assigning port 11226
[2017-04-13 17:57:42,267] INFO  main (PortAssignment.java:32) - assigning port 11227
[2017-04-13 17:57:42,268] INFO  main (PortAssignment.java:32) - assigning port 11228
[2017-04-13 17:57:42,268] INFO  main (PortAssignment.java:32) - assigning port 11229
[2017-04-13 17:57:44,146] INFO  main (CnxManagerTest.java:75) - peerTmpdir:[Ljava.io.File;@704921a5
[2017-04-13 17:57:44,147] INFO  main (JUnit4ZKTestRunner.java:50) - RUNNING TEST METHOD testCnxManager
[2017-04-13 17:57:52,314] INFO  Thread-0 (NIOServerCnxnFactory.java:94) - binding to port 0.0.0.0/0.0.0.0:11222
[2017-04-13 17:57:52,314] INFO  main (NIOServerCnxnFactory.java:94) - binding to port 0.0.0.0/0.0.0.0:11225
[2017-04-13 17:57:53,436] INFO  Thread-1 (QuorumCnxManager.java:504) - My election bind port: 0.0.0.0/0.0.0.0:11223
[2017-04-13 17:58:05,514] INFO  Thread-2 (QuorumCnxManager.java:504) - My election bind port: 0.0.0.0/0.0.0.0:11226
[2017-04-13 17:58:13,900] WARN  Thread-0 (QuorumCnxManager.java:382) - Cannot open channel to 1 at election address 0.0.0.0/0.0.0.0:11226
java.net.ConnectException: Connection refused: connect
	at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method)
	at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:85)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:204)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:368)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:341)
	at org.apache.zookeeper.server.quorum.CnxManagerTest$CnxManagerThread.run(CnxManagerTest.java:101)
[2017-04-13 17:58:24,030] INFO  0.0.0.0/0.0.0.0:11226 (QuorumCnxManager.java:511) - Received connection request /192.168.5.82:63685
[2017-04-13 17:58:24,038] INFO  Thread-0 (QuorumCnxManager.java:193) - Have smaller server identifier, so dropping the connection: (1, 0)
[2017-04-13 17:58:24,879] INFO  0.0.0.0/0.0.0.0:11223 (QuorumCnxManager.java:511) - Received connection request /192.168.5.82:63686
[2017-04-13 17:58:52,292] ERROR Thread-0 (CnxManagerTest.java:123) - Exception while running mock thread
java.net.SocketTimeoutException
	at java.net.SocksSocketImpl.remainingMillis(SocksSocketImpl.java:111)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.testInitiateConnection(QuorumCnxManager.java:170)
	at org.apache.zookeeper.server.quorum.CnxManagerTest$CnxManagerThread.run(CnxManagerTest.java:115)
[2017-04-13 17:58:59,473] ERROR Thread-0 (NIOServerCnxnFactory.java:44) - Thread Thread[Thread-0,5,main] died
java.lang.AssertionError: Unexpected exception
	at org.junit.Assert.fail(Assert.java:91)
	at org.apache.zookeeper.server.quorum.CnxManagerTest$CnxManagerThread.run(CnxManagerTest.java:124)
[2017-04-13 17:59:20,337] INFO  main (JUnit4ZKTestRunner.java:55) - Memory used 17308
[2017-04-13 17:59:20,337] INFO  main (JUnit4ZKTestRunner.java:60) - Number of threads 11
[2017-04-13 17:59:20,338] INFO  main (JUnit4ZKTestRunner.java:65) - FINISHED TEST METHOD testCnxManager
[2017-04-13 17:59:20,338] INFO  main (ZKTestCase.java:60) - SUCCEEDED testCnxManager
[2017-04-13 17:59:20,338] INFO  main (ZKTestCase.java:55) - FINISHED testCnxManager
